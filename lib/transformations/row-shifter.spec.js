'use strict';

const expect = require('chai').expect;
const RowShifter = require('./row-shifter');

describe('RowShifter', () => {

  describe('#shift', () => {

    it('shifts a block of rows correctly', () => {
      let block = [
        [0xd4, 0xe0, 0xb8, 0x1e],
        [0x27, 0xbf, 0xb4, 0x41],
        [0x11, 0x98, 0x5d, 0x52],
        [0xae, 0xf1, 0xe5, 0x30],
      ];
      let shiftedBlock = [
        [0xd4, 0xe0, 0xb8, 0x1e],
        [0xbf, 0xb4, 0x41, 0x27],
        [0x5d, 0x52, 0x11, 0x98],
        [0x30, 0xae, 0xf1, 0xe5],
      ];
      expect(RowShifter.shift(block)).to.eql(shiftedBlock);
    });

  })

  describe('#invshift', () => {

    it('invshifts a block of rows correctly', () => {
      let block = [
        [0xd4, 0xe0, 0xb8, 0x1e],
        [0x27, 0xbf, 0xb4, 0x41],
        [0x11, 0x98, 0x5d, 0x52],
        [0xae, 0xf1, 0xe5, 0x30],
      ];
      let shiftedBlock = [
        [0xd4, 0xe0, 0xb8, 0x1e],
        [0x41, 0x27, 0xbf, 0xb4],
        [0x5d, 0x52, 0x11, 0x98],
        [0xf1, 0xe5, 0x30, 0xae],
      ];
      expect(RowShifter.shiftReverse(block)).to.eql(shiftedBlock);
    });

  })

});
